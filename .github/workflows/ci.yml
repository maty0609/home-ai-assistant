name: CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

env:
  PYTHON_VERSION: '3.13'
  NODE_VERSION: '24'

jobs:
  # Docker build and test
  docker:
    name: Docker Build & Test
    runs-on: ubuntu-latest
    needs: [backend, frontend]

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v3

    - name: Build and test Docker images
      run: |
        # Build backend image
        docker build -t home-ai-backend:test ./backend
        
        # Build frontend image
        docker build -t home-ai-frontend:test ./frontend
        
        # Test backend container
        docker run --rm home-ai-backend:test python -c "print('Backend container test passed')"
        
        # Test frontend container
        docker run --rm home-ai-frontend:test node -e "console.log('Frontend container test passed')"